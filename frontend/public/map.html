<!DOCTYPE html>
<html>
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>

    <style>
      html, body, #map { height: 100%; margin: 0; padding: 0; }
      
      /* Leaflet popup Ã¶zelleÅŸtirme - Premium Glassmorphism Design */
      .leaflet-popup-content-wrapper {
        background: transparent;
        border-radius: 24px;
        padding: 0;
        box-shadow: none;
        border: none;
        min-width: 520px; /* widened for proportional desktop view */
        max-width: 520px;
      }
      
      .leaflet-popup-content {
        margin: 0;
        padding: 0;
        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
        width: 100% !important;
      }
      
      .leaflet-popup-tip-container {
        display: none;
      }
      
      .leaflet-popup-close-button {
        color: white !important;
        font-size: 28px !important;
        padding: 12px 16px !important;
        font-weight: 300 !important;
        z-index: 1000;
        text-shadow: 0 2px 4px rgba(0,0,0,0.2);
        transition: transform 0.2s;
      }
      
      .leaflet-popup-close-button:hover {
        transform: scale(1.1);
      }
      
      /* Container Principal - Square Aspect Ratio */
      .tree-popup-container {
        position: relative;
        width: 520px; /* desktop width */
        min-height: 420px; /* allow vertical growth */
        border-radius: 24px;
        overflow: hidden;
        box-shadow: 
          0 20px 60px rgba(0,0,0,0.3),
          0 8px 20px rgba(0,0,0,0.2),
          inset 0 1px 0 rgba(255,255,255,0.1);
      }
      
      /* Background Image */
      .tree-bg-image {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        object-fit: cover;
        z-index: 1;
        transition: transform .5s ease;
      }
      .tree-popup-container:hover .tree-bg-image { transform: scale(1.03); }
      
      /* Gradient Overlays - Ã‡ift KatmanlÄ± */
      .tree-gradient-overlay-1 {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        z-index: 2;
      }
      
      .tree-gradient-overlay-2 {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        z-index: 3;
      }
      
      /* GenÃ§ AÄŸaÃ§ - YeÅŸil Tonlar */
      .young-tree .tree-gradient-overlay-1 {
        background: linear-gradient(to bottom right, rgba(52, 211, 153, 0.5), rgba(34, 197, 94, 0.7));
      }
      
      .young-tree .tree-gradient-overlay-2 {
        background: linear-gradient(to top, rgba(5, 150, 105, 0.95), transparent);
      }
      
      /* Orta YaÅŸlÄ± AÄŸaÃ§ - Turuncu/SarÄ± */
      .adult-tree .tree-gradient-overlay-1 {
        background: linear-gradient(to bottom right, rgba(251, 191, 36, 0.5), rgba(249, 115, 22, 0.7));
      }
      
      .adult-tree .tree-gradient-overlay-2 {
        background: linear-gradient(to top, rgba(234, 88, 12, 0.95), transparent);
      }
      
      /* Olgun AÄŸaÃ§ - KÄ±rmÄ±zÄ±/Turuncu */
      .elderly-tree .tree-gradient-overlay-1 {
        background: linear-gradient(to bottom right, rgba(249, 115, 22, 0.5), rgba(239, 68, 68, 0.7));
      }
      
      .elderly-tree .tree-gradient-overlay-2 {
        background: linear-gradient(to top, rgba(220, 38, 38, 0.95), transparent);
      }
      
      /* Decorative Blob Shapes - 160x160px */
      .tree-blob-1 {
        position: absolute;
        top: -80px;
        left: -80px;
        width: 160px;
        height: 160px;
        border-radius: 50%;
        filter: blur(64px);
        z-index: 4;
        opacity: 0.3;
      }
      
      .tree-blob-2 {
        position: absolute;
        bottom: -80px;
        right: -80px;
        width: 160px;
        height: 160px;
        border-radius: 50%;
        filter: blur(64px);
        z-index: 4;
        opacity: 0.3;
      }
      
      .young-tree .tree-blob-1 { background: #34d399; }
      .young-tree .tree-blob-2 { background: #10b981; }
      .adult-tree .tree-blob-1 { background: #fbbf24; }
      .adult-tree .tree-blob-2 { background: #f97316; }
      .elderly-tree .tree-blob-1 { background: #f97316; }
      .elderly-tree .tree-blob-2 { background: #ef4444; }
      
      /* Content Container */
      .tree-content {
        position: relative;
        z-index: 10;
        padding: 28px 28px 120px 28px; /* increased bottom padding to make room for absolutely positioned buttons */
        min-height: 100%;
        display: flex;
        flex-direction: column;
      }
      
      /* Header with Tree Icon and Name */
      .tree-header {
        display: flex;
        align-items: center;
        gap: 12px;
        margin-bottom: 16px;
      }
      
      .tree-icon-circle {
        width: 48px;
        height: 48px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 28px;
        backdrop-filter: blur(8px);
        border: 2px solid rgba(255,255,255,0.2);
        box-shadow: 0 4px 12px rgba(0,0,0,0.1);
      }
      
      .young-tree .tree-icon-circle { background: rgba(52, 211, 153, 0.2); }
      .adult-tree .tree-icon-circle { background: rgba(251, 191, 36, 0.2); }
      .elderly-tree .tree-icon-circle { background: rgba(249, 115, 22, 0.2); }
      
      .tree-name-title {
        font-size: 24px;
        font-weight: 700;
        color: white;
        margin: 0;
        text-shadow: 0 2px 8px rgba(0,0,0,0.3);
        flex: 1;
      }
      
      /* Age Badge - KÃ¶ÅŸe Dekorasyonu 80x64px */
      .tree-age-badge {
        position: absolute;
        top: 24px;
        right: 24px;
        padding: 10px 20px;
        border-radius: 16px;
        font-size: 14px;
        font-weight: 700;
        color: white;
        backdrop-filter: blur(8px);
        border: 2px solid rgba(255,255,255,0.2);
        box-shadow: 0 4px 12px rgba(0,0,0,0.2);
        text-transform: uppercase;
        letter-spacing: 0.5px;
      }
      
      .young-tree .tree-age-badge { background: rgba(16, 185, 129, 0.9); }
      .adult-tree .tree-age-badge { background: rgba(249, 115, 22, 0.9); }
      .elderly-tree .tree-age-badge { background: rgba(239, 68, 68, 0.9); }
      
      /* Glassmorphism Info Cards - rounded-2xl (16px) */
      .tree-info-card {
        background: rgba(255, 255, 255, 0.1);
        backdrop-filter: blur(8px);
        border-radius: 16px;
        padding: 16px;
        margin-bottom: 12px;
        border: 1px solid rgba(255,255,255,0.2);
        box-shadow: 
          0 4px 16px rgba(0,0,0,0.1),
          inset 0 1px 0 rgba(255,255,255,0.1);
      }
      
      .tree-info-header {
        display: flex;
        align-items: center;
        gap: 10px;
        margin-bottom: 10px;
      }
      
      .tree-info-icon {
        width: 24px;
        height: 24px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        flex-shrink: 0;
      }
      
      .young-tree .tree-info-icon { background: rgba(52, 211, 153, 0.3); }
      .adult-tree .tree-info-icon { background: rgba(251, 191, 36, 0.3); }
      .elderly-tree .tree-info-icon { background: rgba(249, 115, 22, 0.3); }
      
      .tree-info-label {
        font-size: 14px;
        font-weight: 600;
        color: white;
        text-shadow: 0 1px 2px rgba(0,0,0,0.2);
      }
      
      .tree-info-text {
        font-size: 13px;
        color: rgba(255,255,255,0.9);
        line-height: 1.6;
        padding-left: 34px;
      }
      
      /* Owner Info Card */
      .tree-owner-card {
        display: flex;
        align-items: center;
        gap: 12px;
      }
      
      .tree-owner-icon {
        width: 40px;
        height: 40px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 20px;
        flex-shrink: 0;
      }
      
      .young-tree .tree-owner-icon { background: rgba(52, 211, 153, 0.3); }
      .adult-tree .tree-owner-icon { background: rgba(251, 191, 36, 0.3); }
      .elderly-tree .tree-owner-icon { background: rgba(249, 115, 22, 0.3); }
      
      /* Action Buttons */
      .tree-actions {
        position: absolute;
        left: 28px;
        right: 28px;
        bottom: 32px;
        display: flex;
        gap: 12px;
        margin-top: 0;
      }
      
      .tree-btn {
        flex: 1;
        padding: 16px;
        border: none;
        border-radius: 16px;
        font-size: 15px;
        font-weight: 600;
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 8px;
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        backdrop-filter: blur(8px);
        border: 2px solid rgba(255,255,255,0.2);
        box-shadow: 0 4px 16px rgba(0,0,0,0.2);
        color: white;
        text-shadow: 0 1px 2px rgba(0,0,0,0.2);
      }
      
      .tree-btn:hover {
        transform: translateY(-2px);
        box-shadow: 0 8px 24px rgba(0,0,0,0.3);
      }
      
      .tree-btn:active {
        transform: translateY(0);
      }
      
      .tree-btn-volunteer {
        background: rgba(236, 72, 153, 0.9);
      }
      
      .tree-btn-volunteer:hover {
        background: rgba(219, 39, 119, 1);
      }
      
      .tree-btn-volunteer-active {
        background: rgba(34, 197, 94, 0.9);
      }
      
      .tree-btn-volunteer-active:hover {
        background: rgba(22, 163, 74, 1);
      }
      
      .tree-btn-young {
        background: rgba(16, 185, 129, 0.9);
      }
      
      .tree-btn-young:hover {
        background: rgba(5, 150, 105, 1);
      }
      
      .tree-btn-adult {
        background: rgba(249, 115, 22, 0.9);
      }
      
      .tree-btn-adult:hover {
        background: rgba(234, 88, 12, 1);
      }
      
      .tree-btn-elderly {
        background: rgba(239, 68, 68, 0.9);
      }
      
      .tree-btn-elderly:hover {
        background: rgba(220, 38, 38, 1);
      }
      
      /* Animations */
      @keyframes pulse {
        0%, 100% { opacity: 1; }
        50% { opacity: 0.8; }
      }
      
      @keyframes float {
        0%, 100% { transform: translateY(0); }
        50% { transform: translateY(-10px); }
      }
      
      .tree-blob-1, .tree-blob-2 {
        animation: pulse 3s ease-in-out infinite;
      }
      
      .tree-blob-2 {
        animation-delay: 1.5s;
      }
      
      /* Responsive - Mobile */
      @media (max-width: 480px) {
        .leaflet-popup-content-wrapper {
          min-width: 380px;
          max-width: 380px;
        }
        .tree-popup-container {
          width: 380px;
          min-height: 400px;
        }
        
        .tree-content {
          padding: 22px 22px 110px 22px; /* mobile bottom padding adjusted for new absolute buttons */
        }
        
        .tree-name-title {
          font-size: 20px;
        }
        
        .tree-age-badge {
          font-size: 12px;
          padding: 8px 16px;
        }
      }
    </style>
  </head>

  <body>
		<div id="map"></div>
        
		<script>
          var map = L.map('map').setView([40.80666295981057, 29.358898502754553], 17);

          L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            zoom: 17,
            minZoom: 16,
            maxZoom: 21,
          }).addTo(map);
          L.Browser.retina = false;

          /* const campusBounds = [
            [40.8055, 29.3575], // sol-alt (lat, lng)
            [40.8080, 29.3605]  // saÄŸ-Ã¼st
          ];

          // Map oluÅŸturduktan sonra sÄ±nÄ±r ekle
          map.setMaxBounds(campusBounds);
          map.on('drag', function() {
            map.panInsideBounds(campusBounds, { animate: false });
          }); */

          const treeIcon = L.icon({
            iconUrl: "assets/icons/tree.png", // AÄŸaÃ§ ikonu URL
            iconSize: [32, 32],      // sabit boyut
            iconAnchor: [16, 32],    // alt orta nokta
            popupAnchor: [0, -32],   // popup yukarÄ± kayar
          });

          const trees = [
            { 
              name: "MeÅŸe AÄŸacÄ±", 
              coords: [40.8068, 29.3589], 
              age: "GenÃ§",
              ageType: "young",
              wateringPeriod: "3 GÃ¼nde Bir",
              lastWatered: "12 KasÄ±m 2025",
              hasVolunteer: false,
              owner: null,
              image: "https://images.unsplash.com/photo-1542273917363-3b1817f69a2d?w=800&q=80"
            },
            { 
              name: "Ã‡am AÄŸacÄ±", 
              coords: [40.8065, 29.3592], 
              age: "YetiÅŸkin",
              ageType: "adult",
              wateringPeriod: "5 GÃ¼nde Bir",
              lastWatered: "11 KasÄ±m 2025",
              hasVolunteer: true,
              owner: "Ahmet YÄ±lmaz",
              image: "https://images.unsplash.com/photo-1511497584788-876760111969?w=800&q=80"
            },
            { 
              name: "SÃ¶ÄŸÃ¼t AÄŸacÄ±", 
              coords: [40.8069, 29.3595],
              age: "YaÅŸlÄ±",
              ageType: "elderly",
              wateringPeriod: "Haftada Bir",
              lastWatered: "30 Ekim 2025",
              hasVolunteer: false,
              owner: null,
              image: "https://images.unsplash.com/photo-1502082553048-f009c37129b9?w=800&q=80"
            },
          ];

          function getTreeClassByAge(ageType) {
            if (ageType === "young") return "young-tree";
            if (ageType === "adult") return "adult-tree";
            if (ageType === "elderly") return "elderly-tree";
            return "young-tree";
          }

          function getButtonClass(ageType) {
            if (ageType === "young") return "tree-btn-young";
            if (ageType === "adult") return "tree-btn-adult";
            if (ageType === "elderly") return "tree-btn-elderly";
            return "tree-btn-young";
          }

          trees.forEach(tree => {
            const treeClass = getTreeClassByAge(tree.ageType);
            const buttonClass = getButtonClass(tree.ageType);
            
            const popupContent = `
              <div class="tree-popup-container ${treeClass}">
                <!-- Background Image -->
                <img src="${tree.image}" alt="${tree.name}" class="tree-bg-image">
                
                <!-- Gradient Overlays -->
                <div class="tree-gradient-overlay-1"></div>
                <div class="tree-gradient-overlay-2"></div>
                
                <!-- Decorative Blobs -->
                <div class="tree-blob-1"></div>
                <div class="tree-blob-2"></div>
                
                <!-- Age Badge -->
                <div class="tree-age-badge">${tree.age}</div>
                
                <!-- Content -->
                <div class="tree-content">
                  <!-- Header -->
                  <div class="tree-header">
                    <div class="tree-icon-circle">ðŸŒ²</div>
                    <h3 class="tree-name-title">${tree.name}</h3>
                  </div>
                  
                  <!-- Info Cards -->
                  <div>
                    <!-- Sulama Bilgileri -->
                    <div class="tree-info-card">
                      <div class="tree-info-header">
                        <div class="tree-info-icon">
                          <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="3">
                            <path d="M12 2.69l5.66 5.66a8 8 0 1 1-11.31 0z"/>
                          </svg>
                        </div>
                        <span class="tree-info-label">Sulama Bilgileri</span>
                      </div>
                      <div class="tree-info-text">
                        DÃ¶ngÃ¼: ${tree.wateringPeriod}<br>
                        Son Sulama: ${tree.lastWatered}
                      </div>
                    </div>
                    
                    <!-- Sahip Bilgisi -->
                    ${tree.hasVolunteer ? `
                      <div class="tree-info-card tree-owner-card">
                        <div class="tree-owner-icon">ðŸ‘¤</div>
                        <div>
                          <div class="tree-info-label">GÃ¶nÃ¼llÃ¼</div>
                          <div class="tree-info-text" style="padding-left: 0; margin-top: 2px;">${tree.owner || 'Bilinmiyor'}</div>
                        </div>
                      </div>
                    ` : ''}
                  </div>
                  
                  <!-- Action Buttons -->
                  <div class="tree-actions">
                    <button class="tree-btn ${tree.hasVolunteer ? 'tree-btn-volunteer-active' : 'tree-btn-volunteer'}" onclick="alert('${tree.hasVolunteer ? 'ðŸ˜Š GÃ¶nÃ¼llÃ¼: ' + tree.owner : 'ðŸŒ± GÃ¶nÃ¼llÃ¼ olarak kaydedildiniz!'}')">
                      ${tree.hasVolunteer 
                        ? `<svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/>
                          </svg>
                          GÃ¶nÃ¼llÃ¼sÃ¼ Var`
                        : `<svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"/>
                          </svg>
                          GÃ¶nÃ¼llÃ¼ Ol`
                      }
                    </button>
                    <button class="tree-btn ${buttonClass}" onclick="alert('AÄŸaÃ§ evresi: ${tree.age}')">
                      ${tree.age}
                    </button>
                  </div>
                </div>
              </div>
            `;

            L.marker(tree.coords, { icon: treeIcon })
              .addTo(map)
              .bindPopup(popupContent, {
                maxWidth: 540,
                minWidth: 520,
                className: 'custom-popup',
                closeButton: true
              });
          });
        </script>
	</body>
</html>